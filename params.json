{"name":"Meteor-docker-passenger","tagline":"This repository takes a Meteor bundle and makes it run in Docker with the use of the terrific & battle-tested Phusion Passenger Docker baseimage.","body":"# meteor-docker-passenger\r\n\r\nTO-DO\r\n* Test PhantomJS & spiderable for SEO\r\n\r\n\r\nThis repository takes a Meteor bundle and makes it run in Docker with the use of the terrific &amp; battle-tested Phusion Passenger Docker baseimage. It will create a production-ready Docker image with your Meteor app in it.\r\nThe advantages of using the Phusion Passenger Docker image are numerous.\r\n\r\nWhy use passenger-docker instead of doing everything yourself in Dockerfile?\r\n\r\n * Your Dockerfile can be smaller.\r\n * It reduces the time needed to write a correct Dockerfile. You won't have to worry about the base system and the stack, you can focus on just your app.\r\n * It sets up the base system **correctly**. It's very easy to get the base system wrong, but this image does everything correctly. [Learn more.](https://github.com/phusion/baseimage-docker#contents)\r\n * It drastically reduces the time needed to run `docker build`, allowing you to iterate your Dockerfile more quickly.\r\n * It reduces download time during redeploys. Docker only needs to download the base image once: during the first deploy. On every subsequent deploys, only the changes you make on top of the base image are downloaded.\r\n\r\n And for Meteor in specific:\r\n * It allows making use of multi-core and multi-threading.\r\n * Works great for creating a Microservices based application.\r\n\r\n## Quick Start\r\n\r\n```shell\r\ndocker run -d \\\r\n    -e ROOT_URL=http://yourapp.com \\\r\n    -e MONGO_URL=mongodb://url \\\r\n    -e MONGO_OPLOG_URL=mongodb://oplog_url \\\r\n    -v /dir_containing_bundledir:/home/app/webapp \\\r\n    -p 80:80 \\\r\n    joostlaan/meteor-docker-passenger\r\n```\r\n\r\n## Build + Run it locally\r\n\r\nFirst step is always to put your Meteor bundle in the deploy directory. You could also download the zip for this repository from github and add the files to your Meteor project.\r\n\r\n```shell\r\ndocker build -t myapp . &&\r\ndocker run -d \\\r\n    -e ROOT_URL=http://yourapp.com \\\r\n    -e MONGO_URL=mongodb://url \\\r\n    -e MONGO_OPLOG_URL=mongodb://oplog_url \\\r\n    -p 80:80 \\\r\n    myapp\r\n```\r\n\r\nRun it local and see what's happening in the shell\r\n\r\n```shell\r\ndocker build -t myapp . &&\r\ndocker run -i \\\r\n    -e ROOT_URL=http://yourapp.com \\\r\n    -e MONGO_URL=mongodb://url \\\r\n    -e MONGO_OPLOG_URL=mongodb://oplog_url \\\r\n    -p 80:80 \\\r\n    myapp /sbin/my_init /bin/bash\r\n```\r\n\r\n## Run it local with a Compose.io hosted MongoDB\r\n\r\n```shell\r\ndocker build -t myapp . &&\r\ndocker run -i \\\r\n    -e ROOT_URL=http://localhost \\\r\n    -e MONGO_URL=mongodb://USER:PASS@whitney.0.mongolayer.com:PORT,whitney.1.mongolayer.com:PORT/DBNAME \\\r\n    -e MONGO_OPLOG_URL=mongodb://USER:PASS@whitney.0.mongolayer.com:PORT,whitney.1.mongolayer.com:PORT/local?authSource=DBNAME \\\r\n    -p 80:80 \\\r\n    myapp /sbin/my_init /bin/bash \r\n```\r\n\r\nTag the image, give it a version & push the image to the Tutum.co private Docker repository\r\n```shell\r\ndocker tag myapp tutum.co/USERNAME/myappname:v1 &&\r\ndocker push tutum.co/USERNAME/myappname:v1\r\n```\r\n\r\n## Bonus: Automation with Wercker\r\n\r\nAdd repo in Wercker\r\nMake a commit!\r\n\r\n## Build a Docker image\r\nBuild and test a Docker image. Remember to add the necessary -e environment variables.\r\n\r\n```shell\r\nrm -rf .deploy/bundle &&\r\nmeteor build --directory .deploy &&\r\nsudo docker build -t myapp . &&\r\nrm -rf .deploy/bundle &&\r\ndocker run -i -p 80:80 -t myapp /sbin/my_init /bin/bash \r\n```\r\n","google":"UA-1617166-1","note":"Don't delete this file! It's used internally to help with page regeneration."}